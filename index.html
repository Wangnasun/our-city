<!DOCTYPE html>
<html>
<head>
  <title>视频播放网页</title>
  <script>
    // 视频列表
    var videoList = ["https://v.afbcs.cn/SefkjY", "video2.mp4", "video3.mp4", "video4.mp4"];
    var totalVideos = videoList.length;

    // 统计同时打开网页的人数
    var visitorsCount = localStorage.getItem("visitorsCount");
    if (!visitorsCount) {
      visitorsCount = 0;
    }
    visitorsCount++;
    localStorage.setItem("visitorsCount", visitorsCount);

    // 随机选择一个视频进行预加载
    var selectedVideoIndex;
    if (visitorsCount <= totalVideos) {
      // 每个人选取并预加载不重复的视频
      var assignedVideos = localStorage.getItem("assignedVideos");
      if (!assignedVideos) {
        assignedVideos = [];
      } else {
        assignedVideos = JSON.parse(assignedVideos);
      }

      // 随机选择一个未分配的视频
      var unassignedVideos = videoList.filter(function(video, index) {
        return assignedVideos.indexOf(index) === -1;
      });
      selectedVideoIndex = Math.floor(Math.random() * unassignedVideos.length);
      assignedVideos.push(selectedVideoIndex);
      localStorage.setItem("assignedVideos", JSON.stringify(assignedVideos));
    } else {
      // 所有视频都已分配，可以重复分配
      selectedVideoIndex = Math.floor(Math.random() * totalVideos);
    }

    // 当前时间
    var now = new Date();
    var currentHour = now.getHours();
    var currentMinute = now.getMinutes();
    var currentSecond = now.getSeconds();

    // 抵达指定时间1时自动播放视频
    var targetHour1 = 12;
    var targetMinute1 = 0;
    var targetSecond1 = 0;

    // 抵达指定时间2时自动播放视频
    var targetHour2 = 18;
    var targetMinute2 = 0;
    var targetSecond2 = 0;

    // 检查是否达到指定时间1或指定时间2
    if ((currentHour === targetHour1 && currentMinute === targetMinute1 && currentSecond >= targetSecond1) ||
        (currentHour === targetHour2 && currentMinute === targetMinute2 && currentSecond >= targetSecond2)) {
      // 将视频设置为可见并开始播放
      var videoPlayer = document.getElementById("videoPlayer");
      videoPlayer.style.display = "block";
      videoPlayer.src = videoList[selectedVideoIndex];
      videoPlayer.play();

      // 视频播放完毕后切换回显示当前时间和说明文字的页面
      videoPlayer.addEventListener("ended", function() {
        // 清空相关数据
        localStorage.removeItem("visitorsCount");
        localStorage.removeItem("assignedVideos");

        // 显示当前时间和说明文字
        var messageDiv = document.getElementById("message");
        messageDiv.innerHTML = "当前时间：" + currentHour + ":" + currentMinute + ":" + currentSecond + "<br>请等待指定时间2，重新加载视频。";
      });
    } else {
      // 显示当前时间和说明文字
      var messageDiv = document.getElementById("message");
      messageDiv.innerHTML = "当前时间：" + currentHour + ":" + currentMinute + ":" + currentSecond + "<br>请等待指定时间1或指定时间2播放视频。";
    }

    // 页面加载时开始预加载视频
    window.onload = function() {
      var videoPlayer = document.getElementById("videoPlayer");
      videoPlayer.load();
    };
  </script>
</head>
<body>
  <h1>视频播放网页</h1>
  <div id="message"></div>
  <video id="videoPlayer" style="display: none;"></video>
</body>
</html>
